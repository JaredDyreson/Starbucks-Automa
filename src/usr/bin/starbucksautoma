#!/usr/bin/env python3.5

# official driver code, written by Jared Dyreson
# all rights reserved
# free to use and modify
# NOTE
# please watch for the midnight edge case, so please check the output of the program each time

from starbucksautoma import driver_utils as du
from starbucksautoma import starbucks_week

from selenium import webdriver
from selenium.webdriver.firefox.options import Options

from termcolor import colored

headless_ = Options()
headless_.headless = True
driver = webdriver.Firefox(options=headless_)

pd = du.portal_driver(driver)

pd.go_to_landing_page()

total = 0
end_range = 4
print("[+] Adding the next two weeks....")
for x in range(1, end_range):
	processing_message_ = "[+] Processing week {} of {}".format(x, end_range-1)
	print(colored(processing_message_, 'white', 'on_grey'))	
	print(colored("[+] Merging current week and days working...", 'cyan'))
	filtered_ = pd.filter_stitch()
	week = starbucks_week.starbucks_week(filtered_, pd.get_current_week())
	week.print_contents()
	print("="*80)
	total+=week.get_projected_income()
	week.add_to_calendar()
	pd.go_to_next_week()
	print("="*80)
project_paycheck_message_ = "[+] Projected paycheck amount: ${}".format(total)
print(colored(project_paycheck_message_, 'green'))
print(colored("[+] Killing marionette driver...", 'red'))
pd.kill_marionette()
print("[+] Exiting....")
